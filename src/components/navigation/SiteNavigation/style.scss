@import '../../component';

$minimize-transition: $bitn-navigation-transition;

$width: $bitn-site-navigation-width;
$item-height: $bitn-site-navigation-item-height;
$base-padding: 1rem;
$font-size: $bitn-site-navigation-font-size;
$icon-size: 40%;

$logo-transition: 50ms linear 100ms;
$logo-size: 65%;
$logo-image: '/images/logo.svg';

$background-color: bitn-color(charade);
$highlight-color: bitn-color(baltic);
$text-color: bitn-color(waterloo);

// hover
$hover-background-color: bitn-color(shark);
$hover-text-color: white;

// minimized
$minimized-width: $bitn-navigation-panel-size;
$minimized-logo-size: 60%;
$minimized-logo-image: '/images/logo-sm.svg';
$minimized-padding: ($minimized-width - $item-height) / 2;

.#{class-name(SiteNavigation)} {
  @include display(flex);
  @include flex-direction(column);
  position: fixed;
  padding: 0;
  width: $width;
  height: 100%;
  background-color: $background-color;
  @include transition(width $minimize-transition);
  @include clearfix;
}

.#{ref-name(SiteNavigation, logo)} {
  background: $highlight-color url($logo-image) no-repeat center;
  background-size: $logo-size;
  width: 100%;
  height: $width;

  @include transition(
    height $minimize-transition,
    background-image $logo-transition,
    background-size $logo-transition);
}

// menus
.#{class-name(SiteNavigation)} {
  .#{class-name(Menu)} {
    padding: ($base-padding * 1.5) 0;

    > ul > .#{class-name(MenuItem)} {
      margin: ($base-padding * 0.75) 0;
      @include transition(margin $minimize-transition);

      > a {
        padding: 0 $base-padding;
        font-size: $font-size;
        font-weight: 300;
        color: $text-color;
        line-height: $item-height;
        text-transform: capitalize;
        @include transition(padding $minimize-transition);

        > span {
          float: left;
          margin: 0 $base-padding;
        }

        > i {
          float: right;
          height: $item-height;
          width: $item-height;
          line-height: $item-height;
          background-size: $icon-size;
          @include transition(margin $minimize-transition);
        }
      }

      &.#{state-name(MenuItem, selected)} > div > .#{class-name(Menu)} {
        height: auto;
        padding: ($base-padding * 1.5) 0;
        margin: ($base-padding * 0.5) 0;
        opacity: 1;
      }
      
      &:first-child {
        margin-top: 0;
      }

      &:last-child {
        margin-bottom: 0;
      }
    }
  }
  
  // top menu
  > .#{class-name(Menu)} {
    @include flex(1);
    position: relative;
    overflow-y: auto;
    @include transition(padding $minimize-transition);

    > ul {
      position: absolute;
      right: 0;
      width: $width;
      max-height: 100%;

      > .#{class-name(MenuItem)} {
        > a {
          > i {
            background-color: $highlight-color;
          }

          &:hover {
            background-color: $hover-background-color;
            color: $hover-text-color;

            > i {
              background-color: $highlight-color;
            }
          }

          &:focus {
            background-color: $highlight-color;
          }
        }
      }
    }
  }

  // child menus
  > .#{class-name(Menu)} .#{class-name(Menu)} {
    display: block;
    height: 0;
    margin: 0;
    padding: 0;
    opacity: 0;
    overflow-y: hidden;
    background-color: $hover-background-color;

    @include transition(
      height $minimize-transition,
      margin $minimize-transition,
      padding $minimize-transition,
      opacity $minimize-transition);

    > ul > .#{class-name(MenuItem)} {
      > a {
        padding: 0 ($base-padding * 1.1);

        &:hover, &:focus {
          background-color: $highlight-color;
        }
      }
    }
  }
}

.#{state-name(SiteNavigation, minimized)} {
  width: $minimized-width;

  .#{ref-name(SiteNavigation, logo)} {
    background-image: url($minimized-logo-image);
    background-size: $minimized-logo-size;
    height: $minimized-width;
  }

  // top menu
  > .#{class-name(Menu)} {
    padding: $minimized-padding 0;

    > ul > .#{class-name(MenuItem)} {
      margin: $minimized-padding 0;

      > a {
        padding: 0;

        &, &:hover, &:focus {
          background-color: transparent;
        }

        > i {
          margin: 0 $minimized-padding;
        }
      }

      // hide selected child menus
      &.#{state-name(MenuItem, selected)} > div > .#{class-name(Menu)} {
        display: block;
        height: 0;
        margin: 0;
        padding: 0;
        opacity: 0;
      }
    }
  }
}
